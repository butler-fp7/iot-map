<!DOCTYPE html>
<html lang='en'>
	<head>
		<title>IoT map - BUTLER</title>
		<meta charset='utf-8'>
		<meta content='IE=Edge,chrome=1' http-equiv='X-UA-Compatible'>
		<meta content='width=device-width, initial-scale=1.0' name='viewport'>
 		<link rel="stylesheet" type="text/css" href="/css/butlerui.css">
		<link rel="stylesheet" type="text/css" href="/css/application.css">
		<link rel="stylesheet" type="text/css" href="/css/ol.css">
	</head>
	<body>

	    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
	      <div class="container-fluid">
	        <div class="navbar-header">
	          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
	            <span class="sr-only">Toggle navigation</span>
	            <span class="icon-bar"></span>
	            <span class="icon-bar"></span>
	            <span class="icon-bar"></span>
	          </button>
	          <a class="navbar-brand" href="/">IoT Map | BUTLER devices</a>
	        </div>
	        <div class="navbar-collapse collapse">
	          <ul class="nav navbar-nav">
	            <li><a href="#" data-toggle="modal" data-target="#about"><span class="glyphicon glyphicon-info-sign"></span>&nbsp;About</a></li>
	          </ul>
	     	</div>
	      </div>
	    </div>


		<div class="container-fluid">
		    <div class="row map-area">
		        <div class="col-sm-8">
		  			<div id="map"></div>
		        </div>
		        <div class="col-sm-4 controls">

					<div class="btn-group">
					  <a class="btn btn-default" data-toggle="dropdown" aria-expanded="false">
					    <span class="glyphicon glyphicon-pushpin"></span>&nbsp;Center to <span class="caret"></span>
					  </a>
					  
					  <a class="btn btn-default refresh-devices">
					  	<span class="glyphicon glyphicon-refresh"></span>&nbsp;Reload
					  </a>

					  <a class="btn btn-default auto-refresh-devices">
					  	<span class="glyphicon glyphicon-refresh"></span>&nbsp;Auto refresh
					  </a>

					  <ul class="dropdown-menu" id="locations" role="menu"></ul>
	     		  	  <script type="text/html" id='locations-data'>
					    <% _.each(items,function(item, key, list){ %>
					  		<li><a href="#" data-location="<%= key %>" class="location"><%= item.name %></a></li>
					  	<% }) %>
					  </script>

					</div>

	  			    <img id="loader" src="/images/loader.gif" />

		            <div id="devices"></div>

					<script type="text/html" id='devices-data'>
					    
					    <% _.each(items,function(item, key, list){ %>
					    	<div class="device well" id="device-<%= item.asID %>">
							  <span class="label label-success device-id"><%= key %> - <%= item.asID %></span>
							  <div class="details">
								  <div class="location">
								  	<ul class="list-unstyled">
								  		<li class="coordinates">Coordinates: <span class="lat"></span>, <span class="lng"></span></li>
								  		<li>Height: <span class="height"></span></li>
								  		<li>TimePosEst: <span class="time-pos-est"></span></li>
								  	</ul>
								  </div>
							  </div>
							  <button class="btn btn-primary btn-xs center">
							  	<span class="glyphicon glyphicon-zoom-in"></span>&nbsp;Center on this device
							  </button>
							  <!--
								  <button class="btn btn-primary btn-xs show-details">
								  	<span class="glyphicon glyphicon-eye-open"></span>&nbsp;Show details
								  </button>
							  -->
							</div>
					    <% }) %>

					</script>
		        </div>
		    </div>
		</div>

		<!-- About modal -->
		<div class="modal fade" id="about" tabindex="-1" role="dialog">
		  <div class="modal-dialog">
		    <div class="modal-content">
		      <div class="modal-header">
		        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
		        <h4 class="modal-title" id="myModalLabel">About iotMap</h4>
		      </div>
		      <div class="modal-body">
		      	<p>The <b>iotMap app</b> app has been developed in the context of the <a href="http://wwww.iot-butler.eu">BUTLER project</a>. It shows on a map the positions of devices that are connected to a specific BUTLER gateway.</p>
		      	<p>It uses the <a href="http://open-platforms.eu/library/butler-localization-manager-smartserver/">Localization Manager SmartServer</a> and the <a href="http://open-platforms.eu/library/butler-js/">SmartMobile framework (BUTLERjs)</a>.</p>
		      	<p>Contact details:
		      		<ul>
		      			<li><a href="http://www.ismb.it/francesco.sottile" target="_blank">Francesco Sottile</a> and <a href="http://www.ismb.it/federico.rizzo" target="_blank">Federico Rizzo</a> (<a href="http://www.ismb.it">ISMB</a>)</li>
		      			<li><a mailto="f.clari@inno-group.com">Fabrice Clari</a> (<a href="http://www.inno-group.com">inno TSD</a>)</li>
		      		</ul>
		      	</p>
		      	<p>The source code of this webapp is available on GitHub at: <a href="https://github.com/butler-fp7/iot-map">https://github.com/butler-fp7/iot-map</a>.
		      	</p>
		      </div>
		      <div class="modal-footer">
		        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
		      </div>
		    </div>
		  </div>
		</div>

	</body>

	<script src="js/butler.min.js" type="text/javascript"></script>
    <script src="js/ol.js" type="text/javascript"></script>
	<script src="js/underscore-min.js"></script>
	<script src="js/application.js" type="text/javascript"></script>

</html>
